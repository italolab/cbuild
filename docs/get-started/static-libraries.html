<!DOCTYPE html>

<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Página oficial do foxmake - static libraries - biblioteca estática">
    <meta name="keyworks" content="foxmake, software, windows, linux, build, c, c++">
    <meta name="author" content="Ítalo Herbert Siqueira Gabriel">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="../lib/fontawesome/all.min.css" rel="stylesheet">
    <link href="../lib/prism/prism.css" rel="stylesheet">
    <link href="../style/style.css" rel="stylesheet">
    
    <title>Static Libraries - foxmake - Site oficial</title>

    <script src="../lib/jquery-3.7.1.min.js"></script>    
    <script src="../lib/fontawesome/all.min.js"></script>
    <script src="../js/main.js"></script>
</head>

<body>
    <nav id="nav"></nav>

<div class="d-flex flex-nowrap">
    <aside id="aside"></aside>
    <main>
        <article>
            <header>
                <h1 class="text-center">Criando uma static library</h1>
            </header>

            <p>Uma static library pode ter seu código objeto incluído diretamente no 
            código objeto do seu arquivo executável linkado com a static library. Diferente 
            das dlls, cujo código objeto é carregado dinamicamente.</p>

            <p>Para um exemplo menos detalhado que o exemplo prático, visite: 
                <a href="../overview.html#static-libraries">static libraries</a>
            </p>

            <article id="static-library">
                <p>Para criar uma static library, deve ser utilizado o archiver, ao 
                invés do compilador gcc/g++.</p>

                <p>Vamos a um exemplo prático:</p>

                <ol>
                    <li>Crie dois projetos: libmath e app. (Você pode dar os nomes que quiser).</li>
                    <li>Agora, <b>vá para o projeto libmath</b>, crie o arquivo "libmath.h" com o seguinte 
                        conteúdo: <br /><br />

                        <b><i>libmath.h</i></b><br />
<pre class="line-numbers"><code class="language-cpp">#ifndef LIBMATH_H
#define LIBMATH_H

namespace libmath {

    int fatorial( int n );

}

#endif
</code></pre>
                    </li>

                    <li>Agora crie o arquivo "libmath.cpp" com o seguinte conteúdo: <br /><br />
                        
                        <b><i>libmath.cpp</i></b><br />
<pre class="line-numbers"><code class="language-cpp">#include "libmath.h"

namespace libmath {

    int fatorial( int n ) {
        if ( n &lt;= 1 )
            return 1;
        return n * fatorial( n-1 );
    }

}
</code></pre>                        
                    </li>
                    <li>Agora crie o arquivo foxmakeFile com o seguinte conteúdo: <br /><br />
                        
                        <b><i>foxmakeFile</i></b><br />
<pre class="line-numbers"><code>output.file.name=libmath.a

linker.params=-static
</code></pre>         
                        <p>O CBuidFile acima especifica o arquivo de saída que, no caso de 
                        static libraries, deve começar com "lib" e ter extensão ".a" ou, no 
                        windows, pode ter extensão ".lib" ou ".a". A opção -static é necessária 
                        para o linker gerar a biblioteca estática.</p>

                        <p>Seu projeto deve ter agora a seguinte estrutura de arquivos: </p>
<pre>
libmath
├── foxmakeFile
├── libmath.cpp
└── libmath.h 
</pre>                        
                    </li>
                    <li>Feito isto, pode executar o seguinte comando, estando na raiz 
                        do projeto:<br />
<pre><code>foxmake archivebuildall</code></pre>

                        <p>Esse comando compila todos os arquivos e empacota numa static library.</p>
                        <p>Agora, deve ter sido criado na pasta "build" o arquivo libmath.a</p>
                    </li>
                    <li>Agora <b>vá para o projeto app</b> e copie o arquivo libmath.a para a raiz 
                        do projeto.</li>

                    <li>Crie também uma pasta chamada "include" e copie para ela o arquivo 
                        "libmath.h" do projeto "libmath".</li>

                    <li>Depois, crie o arquivo "main.cpp" com o seguinte conteúdo: <br /><br />

                        <b><i>main.cpp</i></b><br />
<pre class="line-numbers"><code class="language-cpp">#include &lt;libmath.h&gt;

#include &lt;iostream&gt;

using namespace std;


int main() {
    int num;
    cout &lt;&lt; "Informe um numero: " &lt;&lt; std::flush;
    cin >> num;

    int fat = libmath::fatorial( num );

    cout &lt;&lt; endl;
    cout &lt;&lt; "O fatorial de " &lt;&lt; num &lt;&lt; " eh: " &lt;&lt; fat &lt;&lt; endl;

    return 0;
}
</code></pre>
                    </li>
                    <li>Agora crie o foxmakeFile para este projeto com o seguinte conteúdo: <br /><br />
                        <b><i>foxmakeFile</i></b><br />
<pre class="line-numbers"><code>output.file.name=app

build.files=libmath.a

linker.params=-ldl -rdynamic

lib.dirs=.
include.dirs=include
libs=math
</code></pre>
                        <p>As opções <b>-ldl e -rdynamic</b>, são necessárias para linkar bibliotecas 
                        dinâmicas no linux. Se estiver no windows, pode excluir essa linha do 
                        foxmakeFile.</p>

                        <p>A propriedade "build.files" serve apenas para copiar a lib "libmath.a" 
                        para pasta "build", após o a linkagem do executável.</p>

                        <p>Seu projeto deve ter agora a seguinte estrutura de arquivos: </p>
<pre>
app
├── foxmakeFile
├── include
│   └── libmath.h
├── libmath.a
└── main.cpp
</pre>                  
                    </li>
                    <li>Feito isso, pode executar o seguinte comando: <br />
<pre><code>foxmake buildall</code></pre>
                    </li>
                    <li>Agora navegue até a pasta build e execute o executável de nome 
                        "app", conforme a seguir: <br />
<pre><code>cd build
./app
</code></pre>
                        <p>Você interagirá com o programa conforme a seguir: </p>

                        <figure>
                            <img src="../images/libraries-app-output.png" />
                        </figure>
                    </li>
                </ol>
            </article>

            <section>
                <h3>Próxima aula</h3>

                <p>O próxima aula ensina como criar uma biblioteca dinâmica para linux ou 
                windows.</p>
            </section>

            <footer class="d-flex justify-content-between">
                <a class="btn btn-dark" href="tests.html">
                    Anterior
                </a>      
                <a class="btn btn-dark" href="index.html">
                    Cima
                </a>
                <a class="btn btn-dark" href="dynamic-libraries.html">
                    Próxima
                </a>            
            </footer>
        </article>
    </main>
</div>

    <footer>
        <span id="footer"></span>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="../lib/prism/prism.js"></script>
</body>

</html>